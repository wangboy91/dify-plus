# Doubao Ark Video Plugin - 使用示例

## 快速开始

### 1. 配置插件

在 Dify 中导入插件后，进入配置页面填写以下信息：

- **ARK API Key**: 你的豆包方舟 API Key
- **Base URL**: `https://ark.cn-beijing.volces.com` (默认)
- **Model (接入点)**: `doubao-seedance-1-5-pro-251215` (或你的模型接入点)

### 2. 使用 Text to Video (文生视频)

#### 示例 1: 简单场景
```
提示词: "一只可爱的猫咪在草地上玩耍，阳光明媚，背景是蓝天白云"

其他参数使用默认值:
- 生成音频: 是
- 宽高比: 自适应
- 时长: 5秒
```

#### 示例 2: 复杂场景
```
提示词: "女孩抱着狐狸，女孩睁开眼，温柔地看向镜头，狐狸友善地抱着，镜头缓缓拉出，女孩的头发被风吹动，可以听到风声"

参数配置:
- 生成音频: 是
- 宽高比: 16:9
- 时长: 8秒
- 水印: 否
```

### 3. 使用 Image to Video (图生视频)

#### 示例 1: 单图生视频
```
上传 1 张参考图片 (本地文件或 URL)
提示词: "根据这张图片，让角色开始跳舞，保持相同的风格"

参数配置:
- 生成音频: 是
- 宽高比: 自适应
- 时长: 5秒
```

#### 示例 2: 使用 URL 图片
```
参考图片 (直接粘贴 URL):
- https://example.com/image1.jpg

提示词: "根据这张参考图片创建一个有趣的动画场景"

参数配置:
- 生成音频: 是
- 宽高比: 9:16 (竖屏)
- 时长: 5秒
```

## 高级配置

### 轮询参数调整

如果视频生成时间较长，可以调整轮询参数：

- **Polling Interval (轮询间隔)**: 每次查询任务状态的间隔时间（秒）
  - 默认: 5秒
  - 建议范围: 3-10秒

- **Max Polls (最大轮询次数)**: 最多查询多少次
  - 默认: 120次
  - 总等待时间: 轮询间隔 × 最大轮询次数
  - 示例: 5秒 × 120次 = 600秒 (10分钟)

### 视频参数说明

- **Aspect Ratio (宽高比)**:
  - `adaptive`: 自适应 (推荐)
  - `16:9`: 横屏视频
  - `9:16`: 竖屏视频

- **Duration (时长)**:
  - 范围: 1-10秒
  - 推荐: 5秒

- **Generate Audio (生成音频)**:
  - 建议开启，让视频更加生动

- **Watermark (水印)**:
  - 默认不开启
  - 开启后会在视频上添加水印

## 返回结果

成功生成视频后，插件会返回：

1. **视频文件**: 可以直接下载的 MP4 文件
2. **视频 URL**: 在线播放或下载链接
3. **详细信息**: 包含以下数据
   - Task ID (任务ID)
   - Model (使用的模型)
   - Resolution (分辨率)
   - Ratio (宽高比)
   - Duration (时长)
   - FPS (帧率)
   - Seed (随机种子)
   - Usage (Token 使用量)
   - 创建和更新时间

## 常见问题

### Q: 视频生成失败怎么办？
A: 检查以下几点：
1. 确认 API Key 是否正确
2. 检查提示词是否过长（中文建议不超过 500 字）
3. 查看返回的错误信息，根据错误提示调整

### Q: 图片上传失败？
A: 检查图片是否符合要求：
- 格式: jpeg、png、webp、bmp、tiff、gif
- 宽高比: 0.4-2.5 之间
- 尺寸: 300-6000 像素
- 大小: 小于 30MB

### Q: 等待时间太长？
A: 可以调整轮询参数：
- 减小 `poll_interval` (但不要太小，避免频繁请求)
- 增加 `max_polls` 以延长等待时间

### Q: 支持首帧/尾帧视频生成吗？
A: 当前插件支持参考图生视频。如需首帧/尾帧功能，需要修改代码支持 `first_frame` 和 `last_frame` role。

## 提示词编写技巧

1. **清晰描述**: 明确描述你想要的视频内容
2. **分层描述**: 先描述主体，再描述环境，最后描述动作
3. **引用图片**: 使用 `[图1]` 来引用参考图片，效果更好
4. **简洁明了**: 避免过长的描述，突出重点

### 好的提示词示例
```
一个女孩穿着蓝色连衣裙在花海中旋转，阳光从侧面照射，花瓣随风飘舞，镜头缓慢推进
```

### 参考图提示词示例
```
[图1]的女孩站在樱花树下，微笑着看向镜头，春风轻拂她的头发
```
